load('C:\Users\Administrator\Documents\数据挖掘项目\dataset\commerce.mat')
%列向量全部转化为行向量并反向排列
totaltotal=fliplr(totaltotal');
totale=fliplr(totale');
totalbm=fliplr(totalbm');
ebm=fliplr(ebm');
totalca=fliplr(totalca');
eca=fliplr(eca');
totalch=fliplr(totalch');
ech=fliplr(ech');
totalcs=fliplr(totalcs');
ecs=fliplr(ecs');
totaldhb=fliplr(totaldhb');
edhb=fliplr(edhb');
totalea=fliplr(totalea');
eea=fliplr(eea');
totalfbw=fliplr(totalfbw');
efbw=fliplr(efbw');
totalff=fliplr(totalff');
eff=fliplr(eff');
totalmv=fliplr(totalmv');
emv=fliplr(emv');
totaloes=fliplr(totaloes');
eoes=fliplr(eoes');
totalsg=fliplr(totalsg');
esg=fliplr(esg');
totalthg=fliplr(totalthg');
ethg=fliplr(ethg');
totalom=fliplr(totalom');
eom=fliplr(eom');
totalnr=fliplr(totalnr');
enr=fliplr(enr');
%计算行向量的长度
ltotaltotal=length(totaltotal);
ltotale=length(totale);
ltotalbm=length(totalbm);
lebm=length(ebm);
ltotalca=length(totalca);
leca=length(eca);
ltotalch=length(totalch);
lech=length(ech);
ltotalcs=length(totalcs);
lecs=length(ecs);
ltotaldhb=length(totaldhb);
ledhb=length(edhb);
ltotalea=length(totalea);
leea=length(eea);
ltotalfbw=length(totalfbw);
lefbw=length(efbw);
ltotalff=length(totalff);
leff=length(eff);
ltotalmv=length(totalmv);
lemv=length(emv);
ltotaloes=length(totaloes);
leoes=length(eoes);
ltotalsg=length(totalsg);
lesg=length(esg);
ltotalthg=length(totalthg);
lethg=length(ethg);
ltotalom=length(totalom);
leom=length(eom);
ltotalnr=length(totalnr);
lenr=length(enr);
%利用每一项1997-2012年的数据进行2013年的预测
pretotaltotal=arrayfun(@(k)GM11(totaltotal(ltotaltotal-k:end)),0:13);
pretotale=arrayfun(@(k)GM11(totale(ltotale-k:end)),0:13);
pretotalbm=arrayfun(@(k)GM11(totalbm(ltotalbm-k:end)),0:13);
preebm=arrayfun(@(k)GM11(ebm(lebm-k:end)),0:13);
pretotalca=arrayfun(@(k)GM11(totalca(ltotalca-k:end)),0:13);
preeca=arrayfun(@(k)GM11(eca(leca-k:end)),0:13);
pretotalch=arrayfun(@(k)GM11(totalch(ltotalch-k:end)),0:13);
preech=arrayfun(@(k)GM11(ech(lech-k:end)),0:13);
pretotalcs=arrayfun(@(k)GM11(totalcs(ltotalcs-k:end)),0:13);
preecs=arrayfun(@(k)GM11(ecs(lecs-k:end)),0:13);
pretotaldhb=arrayfun(@(k)GM11(totaldhb(ltotaldhb-k:end)),0:13);
preedhb=arrayfun(@(k)GM11(edhb(ledhb-k:end)),0:13);
pretotalea=arrayfun(@(k)GM11(totalea(ltotalea-k:end)),0:13);
preeea=arrayfun(@(k)GM11(eea(leea-k:end)),0:13);
pretotalfbw=arrayfun(@(k)GM11(totalfbw(ltotalfbw-k:end)),0:13);
preefbw=arrayfun(@(k)GM11(efbw(lefbw-k:end)),0:13);
pretotalff=arrayfun(@(k)GM11(totalff(ltotalff-k:end)),0:13);
preeff=arrayfun(@(k)GM11(eff(leff-k:end)),0:13);
pretotalmv=arrayfun(@(k)GM11(totalmv(ltotalmv-k:end)),0:13);
preemv=arrayfun(@(k)GM11(emv(lemv-k:end)),0:13);
pretotaloes=arrayfun(@(k)GM11(totaloes(ltotaloes-k:end)),0:13);
preeoes=arrayfun(@(k)GM11(eoes(leoes-k:end)),0:13);
pretotalsg=arrayfun(@(k)GM11(totalsg(ltotalsg-k:end)),0:13);
preesg=arrayfun(@(k)GM11(esg(lesg-k:end)),0:13);
pretotalthg=arrayfun(@(k)GM11(totalthg(ltotalthg-k:end)),0:13);
preethg=arrayfun(@(k)GM11(ethg(lethg-k:end)),0:13);
pretotalom=arrayfun(@(k)GM11(totalom(ltotalom-k:end)),0:13);
preeom=arrayfun(@(k)GM11(eom(leom-k:end)),0:13);
pretotalnr=arrayfun(@(k)GM11(totalnr(ltotalnr-k:end)),0:13);
preenr=arrayfun(@(k)GM11(enr(lenr-k:end)),0:13);
%灰色融合预测
p=[DataFusionS(pretotaltotal),DataFusionS(pretotale),DataFusionS(pretotalbm),DataFusionS(preebm),DataFusionS(pretotalca),DataFusionS(preeca),DataFusionS(pretotalch),DataFusionS(preech),DataFusionS(pretotalcs),DataFusionS(preecs),DataFusionS(pretotaldhb),DataFusionS(preedhb),DataFusionS(pretotalea),DataFusionS(preeea),DataFusionS(pretotalfbw),DataFusionS(preefbw),DataFusionS(pretotalff),DataFusionS(preeff),DataFusionS(pretotalmv),DataFusionS(preemv),DataFusionS(pretotaloes),DataFusionS(preeoes),DataFusionS(pretotalsg),DataFusionS(preesg),DataFusionS(pretotalthg),DataFusionS(preethg),DataFusionS(pretotalom),DataFusionS(preeom),DataFusionS(pretotalnr),DataFusions(preenr)]


